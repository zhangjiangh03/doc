---
title: 函数
date: 2022-09-25 10:08:00
categories:
- C语言
tags:
- C语言基础
---

函数是C语言中一种非常重要的编程工具，它可以将一段代码封装成具有特定功能的模块，供其他程序调用。函数在程序的结构设计中起着至关重要的作用，它可以使程序更加模块化、可维护和可复用。

## 函数的定义和声明

函数是由一系列语句组成的代码块，可以在程序中独立地执行。
函数可以接受参数并返回一个值，也可以不接受参数或不返回任何值。
C语言中的函数定义包含函数头和函数体两部分。函数头包括函数类型、函数名和参数列表等信息，函数体则包含实现具体功能的语句。

函数的定义通常需要在函数被调用前进行声明，声明函数时需要指定函数类型、函数名和参数列表。

```c
int add(int a, int b) {
    int sum = a + b;
    return sum;
}
```

上面的代码`int`表示函数的类型，`add`是函数名，`(int a, int b)`是参数列表，函数体中的语句是具体的实现功能的代码，函数的功能是求两个整数的和，返回一个整数值。

函数的声明直接指定函数类型、函数名和参数列表。

```c
int add(int a, int b);
```

## 函数的调用

函数定义好后，可以在程序中进行调用。
调用函数时需要指定函数名称和参数列表，根据参数列表的个数、类型和顺序来传递实参。

```c
return_value = function_name(argument_list);
```

`return_value`是返回值，`function_name`是函数名，`argument_list`是参数列表。

```c
#include <stdio.h>

int add(int a, int b) {
    int sum = a + b;
    return sum;
}

int main() {
    int a = 10, b = 20, c;
    c = add(a, b);
    printf("sum is %d\n", c);
    return 0;
}
```

## 函数的参数传递

C语言中的函数可以通过值传递和指针传递两种方式来传递参数。

### 值传递

在值传递过程中，实参的值被拷贝到形参中，函数内部对形参的操作并不会影响到实参的值。
值传递可以保证程序的安全性，防止数据被意外修改。

```c
#include <stdio.h>

void swap(int a, int b) {
    int tmp = a;
    a = b;
    b = tmp;
}

int main() {
    int x = 10, y = 20;
    printf("before swap: x = %d, y = %d\n", x, y);
    swap(x, y);
    printf("after swap: x = %d, y = %d\n", x, y);
    return 0;
}
```

上面的代码定义了一个`swap`函数用于交换两个整数的值。然后在`main`函数中调用这个函数，但是程序没有实现交换的功能，因为`swap`函数使用了值传递，形参的修改不会影响到实参的值。

### 指针传递

指针传递是一种更加高效的参数传递方式，它可以直接操作实参的值，而不需要进行数据拷贝。
在指针传递过程中，实参的地址被传递到形参中，函数内部对形参的操作会直接影响到实参的值。
指针传递可以提高程序的效率，但需要注意指针的安全性，防止出现指针越界、空指针等问题。

```c
#include <stdio.h>

void swap(int *a, int *b) {
    int tmp = *a;
    *a = *b;
    *b = tmp;
}

int main() {
    int x = 10, y = 20;
    printf("before swap: x = %d, y = %d\n", x, y);
    swap(&x, &y);
    printf("after swap: x = %d, y = %d\n", x, y);
    return 0;
}
```

上面的代码`swap`函数使用了指针传递的方式，通过指针来操作变量的值，实现了交换两个整数的功能。

## 函数的返回值

函数可以返回一个值或者不返回任何值。
当函数需要返回一个值时，需要在函数头中指定函数类型，同时在函数体中使用`return`语句来返回计算结果。

```c
#include <stdio.h>

int max(int a, int b) {
    if (a > b) {
        return a;
    } else {
        return b;
    }
}

int main() {
    int x = 10, y = 20, z;
    z = max(x, y);
    printf("max value is %d\n", z);
    return 0;
}
```

上面的代码定义了一个`max`函数用于求两个整数的最大值，然后在`main`函数中调用这个函数，并将返回值赋给变量`z`，最后输出变量`z`的值。

## 变量的作用域和生命周期

C语言中的变量有不同的作用域和生命周期，函数中定义的变量一般只在函数内部有效，其作用域和生命周期都受到函数的限制。

```c
#include <stdio.h>

void test() {
    int i = 0;
    i++;
    printf("i = %d\n", i);
}

int main() {
    int i = 10;
    test();
    printf("i = %d\n", i);
    return 0;
}
```

上面的代码定义了一个`test`函数用于自增一个变量i的值，然后在`main`函数中调用这个函数，并输出变量`i`的值。
由于变量i在`test`函数中定义，因此它的作用域和生命周期只在`test`函数内部有效，执行完`test`函数后变量`i`的值不会影响到`main`函数中的变量i。

## 函数的重载

C语言不支持函数的重载，即一个函数名不能对应多个不同参数列表的函数。如果需要实现相似功能的函数，可以通过改变函数名称或使用参数默认值等方式来实现。

## 函数实例

### assert函数

`assert`函数主要用来进行断言检查，在运行程序时检查某个条件是否成立，并在程序发生错误时打印错误信息。

assert宏的语法：

```text
#include <assert.h>

void assert(int expression);
```

其中`expression`表示要进行检查的条件，通常使用表达式来表示。

```c
#include <stdio.h>
#include <assert.h>

int main() {
	int a = 10;
	assert(a == 5);
	printf("a is %d\n", a);
	return 0;
}
```

上面的代码首先定义了一个整数`a`，并将其赋值为`10`。
在使用`assert`宏进行断言检查时，表达式`a==5`显然为假，因此程序会输出错误信息并终止运行。
由于`assert`函数会用`abort`函数终止程序的运行，因此程序不会执行`printf`语句。