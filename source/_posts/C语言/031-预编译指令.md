---
title: 预编译指令
date: 2022-12-25 13:45:00
categories:
- C语言
tags:
- C语言基础
---

预编译指令（Preprocessor Directives）是C语言中的一种特殊指令，它们在编译之前对源程序进行预处理，可以用来定义常量、宏、条件编译等。

## `#define` 指令

`#define`指令用于定义符号常量和宏函数。

```text
#define symbol value
#define macro(params) replacement
```

其中，`symbol`表示符号常量名称，`value`表示符号常量的值，`macro`表示宏函数名称，`params`表示宏函数的参数列表，`replacement`表示宏函数的替换内容。

```c
#define PI 3.1415926
#define SQUARE(x) ((x)*(x))
```

在程序中，可以直接使用`PI`和`SQUARE(x)`来代替具体的数值和表达式。

## `#include`指令

`#include`指令用于包含其他文件的内容。一般情况下，头文件（.h文件）中包含了一些函数原型、结构体定义和符号常量等，可以让程序员在不了解具体实现时调用这些功能。

```text
#include <filename>
#include "filename"
```

其中，`<filename>`表示系统目录下的文件名，`filename`表示当前文件目录下的文件名。

```c
#include <stdio.h>
```

## 条件编译指令

条件编译指令用于根据条件来选择性地编译源程序的某些部分。常见的条件编译指令有`#if`、`#ifdef`、`#ifndef`、`#else`、`#elif`和`#endif`等。

```text
#if condition
statements
#elif condition
statements
#else
statements
#endif
```

其中，`condition`表示一个布尔表达式，`statements`表示需要编译的语句。如果`condition`为真，则会编译`#if`和`#elif`之间的语句；
如果`condition`为假，则会编译`#elif`和`#else`之间的语句；否则会编译`#else`后面的语句。

```c
#ifdef DEBUG
printf("Debug mode\n");
#else
printf("Release mode\n");
#endif
```

## `#undef`指令

`#undef`指令用于取消先前使用`#define`定义的符号常量或宏函数。

```text
#undef symbol
```

其中，`symbol`表示要取消的符号常量或宏函数名称。例如，以下代码取消了之前定义的符号常量`PI`：

```c
#undef PI
```

## `#pragma `指令

`#pragma`指令用于向编译器传递特定的指令，以实现一些特殊的功能。
不同的编译器支持的`#pragma`指令可能不同，部分常见的`#pragma`指令包括`#pragma pack`和`#pragma warning`等。
例如，以下代码使用`#pragma pack`指令将结构体的对齐方式设置为2字节：

```c
#pragma pack(2)
struct Node
{
    int data;
    char name[10];
};
```