---
title: 指针和函数
date: 2022-09-25 10:15:00
categories:
- C语言
tags:
- C语言
---

指针和函数是C语言中重要的概念，它们的相互协作可以提高程序的效率和可读性。本文将详细介绍指针和函数的相关知识点。

## 函数的基本概念

函数是一段可重复使用的代码块，它封装了一系列操作，可以接收参数并返回值。在C语言中，每个程序都必须有一个`main()`函数作为程序的入口点。当程序执行到`main()`函数时，它就开始运行。
函数定义的一般形式：

```text
返回类型 函数名(参数列表) {
    函数体;
    return 返回值;
}
```

其中，返回类型表示函数返回值的类型，函数名是标识符，参数列表是函数接收的参数，函数体是一组可执行的语句块，`return`语句用于返回函数的值（可选）。

```c
int sum(int a, int b) {
    return a + b;
}
```

## 指针作为函数参数

指针作为函数参数时，可以将变量的地址传递给函数，从而实现通过指针访问参数变量的目的，并且在函数内修改参数的值。

```c
void swap(int *x, int *y) {
    int temp = *x;
    *x = *y;
    *y = temp;
}

int main() {
    int a = 1, b = 2;
    swap(&a, &b);
    printf("a=%d,b=%d\n", a, b);  // 输出 a=2,b=1
    return 0;
}
```

上面的代码`swap`函数接收两个指向整型变量的指针，然后通过指针交换变量的值。在主函数中，定义了两个整型变量`a`和`b`，并将它们的地址传递给`swap`函数。最后输出`a`和`b`的值，可以发现它们的值已经发生了交换。
需要注意：使用指针作为函数参数时，应确保指针指向的内存空间是合法的，并且在函数内不要修改指针所指向的内存位置，否则可能会导致程序运行错误。

## 函数指针

函数指针是一种特殊类型的指针，它指向函数的地址。
通过函数指针，可以动态地调用不同的函数，在实现多态等高级编程技术时非常有用。
函数指针的一般形式：

```text
返回类型 (*指针变量名)(参数列表);
```

其中，`指针变量名`表示指针变量的名称，`返回类型`表示函数返回值的类型，`参数列表`表示函数的参数列表。

```c
int (*fp)(int, int);
```

通过函数指针调用函数时，可以使用指针变量名加上参数列表和调用符号来调用函数。

```c
int add(int a, int b) {
    return a + b;
}

int main() {
    int (*fp)(int, int) = add;
    int result = fp(1, 2);
    printf("result=%d\n", result);  // 输出 result=3
    return 0;
}
```

上面的代码首先定义了一个名为`add`的函数，用于计算两个整数的和。
然后，在主函数中，将`add`函数的地址赋给函数指针`fp`，并通过`fp`调用`add`函数，从而得到函数的返回值，并将其输出。